<html>

<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.5.9/dist/css/uikit.min.css" />
    <!-- UIkit JS -->
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.5.9/dist/js/uikit-icons.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <style>
        .outer {

            position: absolute;
            /* ★ */
            top: 30%;
            left: 50%;
            /* ★ */
            transform: translateY(-40%);
            transform: translateX(-40%);
        }
    </style>
</head>

<body>
    <div uk-sticky="media: 960"
        class="uk-navbar-container tm-navbar-container uk-sticky uk-active uk-sticky-below uk-sticky-fixed"
        style="position: fixed; top: 0px; width: 100%;">
        <div class="uk-container uk-container-expand">
            <nav class="uk-navbar">
                <div class="uk-navbar-center"><a href="../" class="uk-navbar-item uk-logo"><img uk-svg=""
                            src="../images/uikit-logo.svg" class="uk-margin-small-right" hidden=""><svg width="28"
                            height="34" viewBox="0 0 28 34" xmlns="http://www.w3.org/2000/svg"
                            class="uk-margin-small-right uk-svg" data-svg="../images/uikit-logo.svg">
                            <polygon fill="#fff" points="19.1,4.1 13.75,1 8.17,4.45 13.6,7.44 "></polygon>
                            <path fill="#fff"
                                d="M21.67,5.43l-5.53,3.34l6.26,3.63v9.52l-8.44,4.76L5.6,21.93v-7.38L0,11.7v13.51l13.75,8.08L28,25.21V9.07 L21.67,5.43z">
                            </path>
                        </svg> UIkit
                    </a>
                </div>
            </nav>
        </div>
    </div>
    <div class="uk-flex outer" id="working" name="working">
        <form>
            <div class="uk-card uk-card-default uk-card-body uk-margin" uk-margin>
                <div uk-form-custom="target: true">
                    working
                </div>

        </form>
    </div>
    <!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9862173367747325" data-ad-slot="9882320765"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script> -->

</body>
<script>
    
    var intervalID;
    var delay = 10000;
    var max_retry_time = 5;
    var try_count = 0;
    const urlParams = new URLSearchParams(window.location.search);
    var username = urlParams.get('u');
    start_schedule();
    function start_schedule(delay_time) {
        intervalID = setInterval(function () {
            query_status()

        }, delay_time);
    }

    function query_status() {
        clearInterval(intervalID);
        try_count++;
        if (try_count >= max_retry_time) {
            console.log("stop");
            return
        }
        console.log(username);
        $.ajax({
            url: 'http://54.187.219.232/v1/ig/' + username,
            processData: false,
            contentType: false,
            type: 'GET',
            success: function (resp) {
                if (resp.code === 0) {
                    keep_query=false;
                    //$("#working").hide();
                    window.location.href = '/preview.html?u=' + username;
                } else {
                    console.log("失敗");
                    start_schedule(delay);
                }
            }
        });
        
    }
</script>

</html>